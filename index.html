<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIKO ‚Äì Market Analytics Hub</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-primary: #0a0e27;
            --bg-secondary: #151b3d;
            --bg-card: #1a2145;
            --accent: #00d9ff;
            --accent-hover: #00b8d9;
            --text-primary: #ffffff;
            --text-secondary: #8b93b8;
            --success: #00ff88;
            --danger: #ff3366;
            --border: #2a3351;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        header {
            background: var(--bg-secondary);
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.6rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--accent), #0099ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s;
            font-weight: 500;
        }
        .nav-links a:hover, .nav-links a.active { color: var(--accent); }

        .theme-toggle {
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .theme-toggle:hover {
            background: var(--accent);
            border-color: var(--accent);
        }

        .container { max-width: 1400px; margin: 0 auto; padding: 2rem; }
        .hero { display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; margin-bottom: 3rem; }

        .card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid var(--border);
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
        }
        .card h2 { margin-bottom: 1.5rem; font-size: 1.4rem; }

        .chart-container { position: relative; height: 400px; }

        .stock-list { display: flex; flex-direction: column; gap: 1rem; }
        .stock-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 1rem; background: var(--bg-secondary); border-radius: 12px;
            transition: transform 0.2s; cursor: pointer;
        }
        .stock-item:hover { transform: translateX(5px); }
        .stock-info { display: flex; flex-direction: column; }
        .stock-ticker { font-weight: bold; font-size: 1.1rem; }
        .stock-name { color: var(--text-secondary); font-size: 0.9rem; }
        .stock-price { display: flex; flex-direction: column; align-items: flex-end; }
        .price { font-weight: bold; font-size: 1.1rem; }
        .change { padding: 0.25rem 0.75rem; border-radius: 6px; font-size: 0.9rem; font-weight: 600; }
        .change.positive { background: rgba(0, 255, 136, 0.1); color: var(--success); }
        .change.negative { background: rgba(255, 51, 102, 0.1); color: var(--danger); }

        .section { margin: 3rem 0; }

        .news-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 2rem; }
        .news-card {
            background: var(--bg-card); border-radius: 16px; padding: 1.5rem;
            border: 1px solid var(--border); transition: transform 0.3s; cursor: pointer;
        }
        .news-card:hover { transform: translateY(-5px); border-color: var(--accent); }
        .news-title { font-size: 1.1rem; margin-bottom: 0.5rem; }
        .news-meta { color: var(--text-secondary); font-size: 0.9rem; }

        .trending-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem; margin-top: 1.5rem;
        }
        .trend-card {
            background: var(--bg-secondary); padding: 1rem;
            border-radius: 12px; text-align: center; font-weight: 600;
        }

        @media (max-width: 768px) { .hero { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
<header>
    <nav>
        <div class="logo">SIKO-Broking</div>
        <div class="nav-links">
            <a href="#" class="active" data-page="home">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="#" data-page="news">–ù–æ–≤–æ—Å—Ç–∏</a>
            <a href="#" data-page="stocks">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∞–∫—Ü–∏–∏</a>
            <button class="theme-toggle" onclick="toggleTheme()">üåì</button>
        </div>
    </nav>
</header>

<div class="container">
    <div id="homePage">
        <div class="hero">
            <div class="card">
                <h2>S&P 500 Index</h2>
                <div class="chart-container"><canvas id="marketChart"></canvas></div>
            </div>
            <div class="card">
                <h2>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∞–∫—Ü–∏–∏</h2>
                <div class="stock-list" id="stockList"></div>
            </div>
        </div>

        <div class="card">
            <h2>–ì–æ—Ä—è—á–∏–π —á–∞—Å</h2>
            <div class="trending-grid" id="trendingGrid"></div> 
        </div>
    </div>

    <div id="newsPage" class="section" style="display:none;">
        <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞</h2>
        <div class="news-grid" id="newsGrid"></div>
    </div>

    <div id="analyticsPage" class="section" style="display:none;">
        <h2>üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä—ã–Ω–∫–∞</h2>
        <div class="card">
        <h3>S&P 500 —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏</h3>
        <div class="chart-container" style="height:500px;">
            <canvas id="analyticsChart"></canvas>
        </div>
        </div>
        <div class="card" style="margin-top:2rem;">
            <h3>–¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h3>
            <ul id="indicatorsList" style="margin-top:1rem; line-height:1.8; color:var(--text-secondary);">
            <li>RSI: <span id="rsiValue">--</span></li>
            <li>EMA(14): <span id="emaValue">--</span></li>
            </ul>
        </div>
    </div>


    <div id="stocksPage" class="section" style="display:none;">
        <h2>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∞–∫—Ü–∏–∏</h2>
        <div class="card" style="margin-bottom:1rem;">
            <h3>–ü–æ–∏—Å–∫ –∞–∫—Ü–∏–∏</h3>
            <div style="display:flex;gap:.5rem;margin-top:.5rem;">
            <input id="stockSearchInput" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–∏–∫–µ—Ä, –Ω–∞–ø—Ä–∏–º–µ—Ä AAPL"
                style="flex:1;padding:.6rem;border-radius:8px;border:1px solid var(--border);background:var(--bg-secondary);color:var(--text-primary);">
            <button onclick="searchStock()" 
                style="padding:.6rem 1rem;border:none;border-radius:8px;background:var(--accent);color:#fff;font-weight:600;cursor:pointer;">
                –ù–∞–π—Ç–∏
            </button>
            </div>
            <div id="searchResult" style="margin-top:1rem;"></div>
        </div>

        <!-- üìà –¢–æ–ø –ø–æ —Ä–æ—Å—Ç—É -->
        <div class="card">
            <h3>–¢–æ–ø –ø–æ —Ä–æ—Å—Ç—É</h3>
            <div class="stock-list" id="topGainers"></div>
        </div>

        <!-- üìä –¢–æ–ø –ø–æ –æ–±—ä—ë–º—É -->
        <div class="card" style="margin-top:1rem;">
            <h3>–¢–æ–ø –ø–æ –æ–±—ä—ë–º—É</h3>
            <div class="stock-list" id="topVolume"></div>
        </div>
    </div>

    <div id="aiPage" class="section" style="display:none;">
        <h2>AI-–°–æ–≤–µ—Ç–Ω–∏–∫ —Ç—Ä–µ–π–¥–µ—Ä–∞</h2>
        <div class="card" style="margin-top: 1rem;">
            <p>–ß–∞—Ç —Å AI –¥–æ—Å—Ç—É–ø–µ–Ω –∑–¥–µ—Å—å (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ OpenRouter API).</p>
        </div>
    </div>

            
</div>

</div>



<script>
    const stocks = [
        { ticker: 'AAPL', name: 'Apple Inc.', price: 178.32, change: 2.45 },
        { ticker: 'NVDA', name: 'NVIDIA Corp.', price: 498.21, change: 5.23 },
        { ticker: 'TSLA', name: 'Tesla Inc.', price: 248.55, change: -1.84 },
        { ticker: 'MSFT', name: 'Microsoft Corp.', price: 378.91, change: 1.67 }
    ];

    const news = [
        { title: '–§–†–° —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞ —Å—Ç–∞–≤–∫—É –Ω–∞ —É—Ä–æ–≤–Ω–µ 5.25-5.5%', date: '29 —Å–µ–Ω—Ç—è–±—Ä—è 2025' },
        { title: 'NVIDIA –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∞ –Ω–æ–≤—ã–µ AI-—á–∏–ø—ã', date: '28 —Å–µ–Ω—Ç—è–±—Ä—è 2025' },
        { title: '–¶–µ–Ω—ã –Ω–∞ –Ω–µ—Ñ—Ç—å –≤—ã—Ä–æ—Å–ª–∏ –¥–æ $95', date: '28 —Å–µ–Ω—Ç—è–±—Ä—è 2025' },
        { title: 'Apple –æ–±—ä—è–≤–∏–ª–∞ –æ –≤—ã–∫—É–ø–µ –∞–∫—Ü–∏–π', date: '27 —Å–µ–Ω—Ç—è–±—Ä—è 2025' }
    ];

    function renderStocks() {
        const stockList = document.getElementById('stockList');
        stockList.innerHTML = stocks.map(stock => `
            <div class="stock-item">
                <div class="stock-info">
                    <div class="stock-ticker">${stock.ticker}</div>
                    <div class="stock-name">${stock.name}</div>
                </div>
                <div class="stock-price">
                    <div class="price">$${stock.price.toFixed(2)}</div>
                    <div class="change ${stock.change > 0 ? 'positive' : 'negative'}">
                        ${stock.change > 0 ? '‚Üë' : '‚Üì'} ${Math.abs(stock.change).toFixed(2)}%
                    </div>
                </div>
            </div>
        `).join('');
    }

    function renderNews() {
        const newsGrid = document.getElementById('newsGrid');
        newsGrid.innerHTML = news.map(item => `
            <div class="news-card">
                <div class="news-title">${item.title}</div>
                <div class="news-meta">üìÖ ${item.date}</div>
            </div>
        `).join('');
    }

    function createChart() {
        const ctx = document.getElementById('marketChart').getContext('2d');
        const data = Array.from({length: 30}, () => 4700 + Math.random() * 100);
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: Array.from({length: 30}, (_, i) => `–î–µ–Ω—å ${i+1}`),
                datasets: [{
                    label: 'S&P 500',
                    data: data,
                    borderColor: '#00d9ff',
                    backgroundColor: 'rgba(0, 217, 255, 0.1)',
                    tension: 0.4, fill: true
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { ticks: { color: '#8b93b8' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                    x: { ticks: { color: '#8b93b8' }, grid: { display: false } }
                }
            }
        });
    }

    function toggleTheme() { document.body.classList.toggle('light-theme'); }

    document.querySelectorAll('.nav-links a').forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            document.querySelectorAll('.nav-links a').forEach(l => l.classList.remove('active'));
            link.classList.add('active');
            const page = link.dataset.page;
            document.querySelectorAll('[id$="Page"]').forEach(p => p.style.display = 'none');
            document.getElementById(page + 'Page').style.display = 'block';
        });
    });

    const topGainers = [
        { ticker: 'NVDA', name: 'NVIDIA Corp.', price: 498.21, change: 5.23 },
        { ticker: 'AMD', name: 'AMD Inc.', price: 128.45, change: 4.12 }
    ];
    const topVolume = [
        { ticker: 'AAPL', name: 'Apple Inc.', price: 178.32, volume: '120M' },
        { ticker: 'TSLA', name: 'Tesla Inc.', price: 248.55, volume: '95M' }
    ];

    function renderTopStocks() {
        document.getElementById('topGainers').innerHTML = topGainers.map(stock => `
            <div class="stock-item">
                <div class="stock-info"><div class="stock-ticker">${stock.ticker}</div><div class="stock-name">${stock.name}</div></div>
                <div class="stock-price"><div class="price">$${stock.price.toFixed(2)}</div>
                <div class="change positive">‚Üë ${stock.change.toFixed(2)}%</div></div>
            </div>
        `).join('');
        document.getElementById('topVolume').innerHTML = topVolume.map(stock => `
            <div class="stock-item">
                <div class="stock-info"><div class="stock-ticker">${stock.ticker}</div><div class="stock-name">${stock.name}</div></div>
                <div class="stock-price"><div class="price">$${stock.price.toFixed(2)}</div>
                <div style="color: var(--text-secondary); font-size: 0.9rem;">Vol: ${stock.volume}</div></div>
            </div>
        `).join('');
    }

    renderStocks(); renderNews(); renderTopStocks(); createChart();
    const API_KEY = "d3dd6dpr01qg5k5r4910d3dd6dpr01qg5k5r491g"; // —Å—é–¥–∞ –≤—Å—Ç–∞–≤—å –∫–ª—é—á —Å finnhub.io

// –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∞–∫—Ü–∏—è–º
async function fetchStockPrice(symbol) {
    const res = await fetch(`https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${API_KEY}`);
    return res.json();
}

// –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤–æ—Å—Ç–∏
async function fetchMarketNews() {
    const res = await fetch(`https://finnhub.io/api/v1/news?category=general&token=${API_KEY}`);
    return res.json();
}

// –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ü–∏–∏
async function updateStocks() {
    const symbols = ["AAPL", "TSLA", "NVDA", "MSFT"];
    const stockList = document.getElementById('stockList');
    stockList.innerHTML = "";

    for (let s of symbols) {
        const data = await fetchStockPrice(s);
        const price = data.c; // —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞
        const change = ((data.c - data.pc) / data.pc * 100).toFixed(2); // % –∏–∑–º–µ–Ω–µ–Ω–∏—è

        stockList.innerHTML += `
            <div class="stock-item">
                <div class="stock-info">
                    <div class="stock-ticker">${s}</div>
                </div>
                <div class="stock-price">
                    <div class="price">$${price.toFixed(2)}</div>
                    <div class="change ${change >= 0 ? "positive" : "negative"}">
                        ${change >= 0 ? "‚Üë" : "‚Üì"} ${change}%
                    </div>
                </div>
            </div>
        `;
    }
}

// –û–±–Ω–æ–≤–ª—è–µ–º –Ω–æ–≤–æ—Å—Ç–∏
async function updateNews() {
    const news = await fetchMarketNews();
    const newsGrid = document.getElementById("newsGrid");
    newsGrid.innerHTML = news.slice(0, 6).map(n => `
        <div class="news-card">
            <div class="news-title">${n.headline}</div>
            <div class="news-meta">üìÖ ${new Date(n.datetime * 1000).toLocaleDateString()}</div>
        </div>
    `).join('');
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
setInterval(() => {
    updateStocks();
    updateNews();
}, 5000);

// –ü–µ—Ä–≤–∏—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
updateStocks();
updateNews();
async function fetchTrendingNews() {
    const res = await fetch(`https://finnhub.io/api/v1/news?category=general&token=${API_KEY}`);
    return res.json();
}

async function updateTrendingNews() {
    const news = await fetchTrendingNews();
    const trendingGrid = document.getElementById("trendingGrid");

    trendingGrid.innerHTML = news.slice(0, 5).map(n => `
        <div class="trend-card" onclick="window.open('${n.url}', '_blank')">
            <div style="font-size:0.9rem; color:var(--text-secondary); margin-bottom:5px;">
                ${new Date(n.datetime * 1000).toLocaleDateString()}
            </div>
            <div style="font-weight:600;">${n.headline}</div>
        </div>
    `).join('');
}

// –ü–µ—Ä–≤–∏—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
updateTrendingNews();

// –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 60 –º–∏–Ω—É—Ç
setInterval(updateTrendingNews, 3600000);

const FMP_API_KEY = "vmvuvLIJOyjTnYan3jElhHPuPG2gz150";

async function searchStock() {
  const input = document.getElementById('stockSearchInput');
  const query = input.value.trim().toUpperCase();
  const resultEl = document.getElementById('searchResult');

  if (!query) {
    resultEl.innerHTML = '<div class="muted">–í–≤–µ–¥–∏—Ç–µ —Ç–∏–∫–µ—Ä –∞–∫—Ü–∏–∏.</div>';
    return;
  }

  resultEl.innerHTML = '<div class="muted">–ó–∞–≥—Ä—É–∑–∫–∞...</div>';

  try {
    const url = `https://financialmodelingprep.com/api/v3/quote/${encodeURIComponent(query)}?apikey=${FMP_API_KEY}`;
    const data = await safeFetch(url);

    if (!data || !Array.isArray(data) || data.length === 0) {
      resultEl.innerHTML = '<div class="muted">–ê–∫—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.</div>';
      return;
    }

    const stock = data[0];
    const changePercent = stock.changesPercentage || 0;

    resultEl.innerHTML = `
      <div class="stock-item">
        <div>
          <div class="stock-ticker">${stock.symbol}</div>
          <div class="stock-name muted small">${stock.name || "–ö–æ–º–ø–∞–Ω–∏—è"}</div>
        </div>
        <div class="stock-price">
          <div class="price">$${stock.price.toFixed(2)}</div>
          <div class="change ${changePercent >= 0 ? 'positive' : 'negative'}">
            ${changePercent >= 0 ? '‚Üë' : '‚Üì'} ${changePercent.toFixed(2)}%
          </div>
        </div>
      </div>
    `;
  } catch (err) {
    console.error("–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –∞–∫—Ü–∏–∏:", err);
    resultEl.innerHTML = '<div class="muted">–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.</div>';
  }
}

async function updateTopLists() {
  const gainersEl = document.getElementById('topGainers');
  const volumeEl = document.getElementById('topVolume');

  gainersEl.innerHTML = '<div class="muted">–ó–∞–≥—Ä—É–∑–∫–∞...</div>';
  volumeEl.innerHTML = '<div class="muted">–ó–∞–≥—Ä—É–∑–∫–∞...</div>';

  try {
    const [gainersData, activeData] = await Promise.all([
      safeFetch(`https://financialmodelingprep.com/api/v3/stock_market/gainers?apikey=${FMP_API_KEY}`),
      safeFetch(`https://financialmodelingprep.com/api/v3/stock_market/actives?apikey=${FMP_API_KEY}`)
    ]);

    // –¢–æ–ø –ø–æ —Ä–æ—Å—Ç—É
    if (Array.isArray(gainersData)) {
      gainersEl.innerHTML = gainersData.slice(0, 5).map(s => `
        <div class="stock-item" onclick="onTickerClick('${s.symbol}')">
          <div>
            <div class="stock-ticker">${s.symbol}</div>
            <div class="stock-name muted small">${s.name || "–ö–æ–º–ø–∞–Ω–∏—è"}</div>
          </div>
          <div class="stock-price">
            <div class="price">$${s.price.toFixed(2)}</div>
            <div class="change positive">
              ‚Üë ${s.change.toFixed(2)} (${s.changesPercentage.toFixed(2)}%)
            </div>
          </div>
        </div>
      `).join('');
    }

    // –¢–æ–ø –ø–æ –æ–±—ä—ë–º—É
    if (Array.isArray(activeData)) {
      volumeEl.innerHTML = activeData.slice(0, 5).map(s => `
        <div class="stock-item" onclick="onTickerClick('${s.symbol}')">
          <div>
            <div class="stock-ticker">${s.symbol}</div>
            <div class="stock-name muted small">${s.name || "–ö–æ–º–ø–∞–Ω–∏—è"}</div>
          </div>
          <div class="stock-price">
            <div class="price">$${s.price.toFixed(2)}</div>
            <div class="muted small">Vol: ${s.volume.toLocaleString()}</div>
          </div>
        </div>
      `).join('');
    }

  } catch (err) {
    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–ø-–ª–∏—Å—Ç–æ–≤:", err);
    gainersEl.innerHTML = '<div class="muted">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>';
    volumeEl.innerHTML = '<div class="muted">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>';
  }
}

// –ü–µ—Ä–≤–∏—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
updateTopLists();
// –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑ –≤ –¥–µ–Ω—å (24—á)
setInterval(updateTopLists, 86400000);

async function safeFetch(url) {
  try {
    const res = await fetch(url);
    if (!res.ok) throw new Error(res.statusText);
    return await res.json();
  } catch (err) {
    console.error("safeFetch error:", err);
    return null;
  }
}


</script>
</body>
</html>

